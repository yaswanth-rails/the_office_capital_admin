<script>
  $(document).ready(function() {
    $('#country').change(function() {
      $.ajax({
        url: "/states",
        data: {country: $("#country").val()},
        dataType: "script",
        method: "get",
        success: function(r){
        }
      });
    });
  });
</script>
  
<div class="field">
  <% user = User.find(params[:id]) rescue nil %>
  <%countries = JSON.parse(File.read("#{Rails.root}/public/countries.json")) rescue []%>
  <%if user.present? and user.country.present?%>
    <%= select_tag "user[country]", options_for_select(countries.map {|c| [c["name"], c["code"]] },user.country), {id: "country", disabled: true} %> 
  <%else%>
    <%countries.prepend({"isoCode"=>"","name"=>"Choose a country"}) %>
    <%= select_tag "user[country]", options_for_select(countries.map {|c| [c["name"], c["code"]] },""), {id: "country"} %> 
  <%end%>
</div>

    

